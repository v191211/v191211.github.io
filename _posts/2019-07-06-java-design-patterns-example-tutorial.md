---
layout: post
title: "Java 设计模式"
categories: ["技术"]
tags: ["设计模式"]
---

* 目录
{:toc .toc}


![]({{ site.url }}/assets/images/posts/Java-Design-Patterns.png)



**设计模式**在软件开发者中非常流行，是对常见软件问题的最佳解决方案。



## Java 设计模式

使用设计模式的一些好处如下：

1. 对于经常出现的问题，设计模式提供了**行业标准**的解决方案，合理的使用设计模式能够节省时间。Java 项目中能够使用很多种设计模式。
2. 使用设计模式能够提高代码的**可用性**和**健壮性**。减少软件项目中总体时间成本。
3. 由于设计模式是行业标准，使用它可以使得我们的代码更加容易理解和调试、让我们能够更快速的进行开发、团队新成员能够很容易的理解它。

![]({{ site.url }}/assets/images/posts/java-design-patterns2.png)

**设计模式**被分为三种类型——**创建型**、**结构型**、**行为型**设计模式。这篇文章是我目前为止写过的所有的设计模式的一个索引。

* 创建型设计模式
  * 单例模式
  * 工厂模式
  * 抽象工厂模式
  * 生成器模式
  * 原型模式
* 结构型设计模式
  * 适配器模式
  * 组合模式
  * 代理模式
  * 享元模式
  * 外观模式
  * 桥接模式
  * 装饰模式
* 行为型设计模式
  * 模板方法模式
  * 中介者模式
  * 责任链模式
  * 观察者模式
  * 策略模式
  * 命令模式
  * 状态模式
  * 访问者模式
  * 解释器模式
  * 迭代器模式
  * 备忘录模式
* 其它设计模式
  * DAO 设计模式
  * 依赖注入设计模式
  * MVC 模式



## 创建型设计模式

创建型设计模式对于具体的状况提供最佳实例化对象的解决方案。

### 1. 单例模式

单例模式约束类的实例对象，确保一个类文件在 Java 虚拟机中只能存在一个实例对象。

看上去非常简单，但是它的实现有许多值得关注的地方。

单例模式的实现在开发者中一直存有争议。

点击设计模式学习不同方式实现单例模式以及每种方式的优缺点。

这是讨论最多的设计模式之一。

### 2. 工厂模式

当我们有一个父类，父类下面有多个子类；基于输入需要返回其中一个子类时可以使用工厂模式。

工厂模式将实例化对象的责任从客户端转移到了工厂类中。

我们可以将单例模式应用到工厂类上面，或者将工厂方法标记为静态方法。

点击查看工厂模式的示例代码和好处。

这是设计模式中使用最多的一种。

### 3. 抽象工厂模式

抽象工厂模式类似于工厂模式，是工厂的工厂。

如果你熟悉工厂设计模式，就会知道有一个单独的工厂类基于输入使用 if-else 或 switch 语句返回不同的子类对象。

抽象工厂模式摆脱了 if-else 代码块，每一个子类对应的都有一个工厂类，抽象工厂类基于输入的工厂类返回相应的子类对象。

通过代码示例了解抽象工厂模式的实现。

### 4. 生成器模式

该模式用于解决使用工厂模式或抽象工厂模式时，要创建的的对象含有大量属性的问题。

生成器模式通过提供一步一步构建对象的方式和一个返回最终构建好的对象的方法来解决对象中存在大量可选参数和状态不一致的问题。

点击生成器模式查看示例代码和在 JDK 中的使用。

### 5. 原型模式

原型模式的使用场景是创建对象的代价很高，需要大量的时间和资源并且内存中已经有了一个类似的对象。

所以该模式提供了一种机制，从复制原对象为一个新的对象，然后根据我们的需要修改它。

该模式使用的是 Java 中的 cloning 技术完成的对象复制。

原型模式要求被复制的对象具有可复制的特性，而不是借由其它类完成复制的操作。

使用浅拷贝还是深拷贝取决于实际需要，这属于设计决策。

点击原型模式查看示例代码。

## 结构型设计模式

结构型模式提供不同的方式创建类结构，例如使用继承与组合根据一些小的对象创建出一个大的对象。

### 1. 适配器模式

适配器模式用于让两个毫不不相干的接口可以一起工作。

连接这些不相干的接口的对象被称为适配器。拿现实中的事情举例，手机充电器就是适配器，因为手机电池充电需要3伏特电压，但是常规的插座提供的是120伏特（美国）或240伏特（印度）的电压。因此手机充电器就像一个手机充电插槽和电源插座间的适配器。

点击适配器模式查看示例代码和在 Java 中的使用。

### 2. 组合模式

组合模式的使用场景是当我们必须表现出”部分-整体“层级，并且需要创建出一种结构，该结构中的所有对象都会被以相同的方式进行操作，这时我们就可以使用组合模式。

举一个现实生活中的例子，图表是种包含各种对象的结构，例如：圆、线、三角等等。

当我们用颜色填充这些图画（比如红色），图画中的对象同样被填充为同一种颜色。

这里的图像由不同部分组成，并且它们具有相同的操作。

点击组合模式查看组合模式的不同组合的示例代码。

### 3. 代理模式

代理模式的意图是为其它对象提供一个代理进而控制对该对象的访问。

定义本身非常清楚，当我们想要一个方法的访问受控制时经常使用代理模式。

比如说我们有一个可以运行一些操作系统命令的类，如果只是我们自己使用，这没什么问题，可是如果我们想把它提供给客户端程序使用就有可能发生严重的问题，因为客户端程序可能会执行删除系统文件或改变某些我们不希望改变的配置的命令。

点击代理模式查看代码实现细节。

### 4. 享元模式

享元模式经常被用于当我们需要创建大量对象时。

由于每个对象都需要消耗内存空间，而这些内存空间对于低内存设备可能是非常重要的，例如手机设备或嵌入式设备。

享元模式通过共享对象的方式能够降低内存的负载，Java 中的字符串池的实现就是享元模式最好的应用场景之一。

点击享元模式查看示例代码和实现过程。

### 5. 外观模式

外观模式用来帮助客户端程序同系统简单的进行交互。

假设我们有一个应用，应用中包含一组使用 Mysql/Oracle 数据库的接口，生成不同类型的报表。例如：HTML 报表、PDF 报表等等。

为此，针对不同类型的数据库我们有不同类型的接口，客户端程序能够使用这些接口获取需要的数据库连接，然后生成报表。

但是当复杂度增加或接口名称引起歧义时，客户端程序很难维护这些接口。

这时可以使用外观模式，提供一个包装的接口帮助客户端程序，该包装接口是现有接口的顶层接口。

点击外观模式查看实现细节。

### 6. 桥接模式

当接口和实现之间有层级关系，可以使用桥接模式将接口从实现中解耦出来，并且隐藏客户端程序的实现细节。

桥接模式的实现遵循多用组合少用继承的概念。

点击桥接模式查看实现细节。

### 7. 装饰模式

装饰器模式用于在程序运行时修改对象的方法，同时相同类的其它实例不会因此而受到影响，只有指定的对象具有修改后的行为。

装饰模式使用抽象类或接口，利用组合的方式进行实现。

我们使用继承或组合扩展对象的行为，但这是在编译时期就完成的，并且作用于类的所有实例对象。我们无法在程序运行时添加任何新的方法移除任何已存在的行为——装饰模式就是为了解决这种场景的。

点击装饰模式查看示例代码。

## 行为型设计模式

行为型设计模式提供对象之间更好的进行交互的解决方案以及代码的松耦合、灵活扩展。

### 1. 模板方法模式

模板方法用来创建一个方法存根，推迟一些实现步骤，交由子类去完成。

模板方法定义执行算法的步骤，可以提供能够被全部或部分子类使用的默认实现。

假设我们想要提供一个建造房子的算法，这些建造房子的步骤是：打地基、立柱子、砌墙、装窗户。

关键点是我们不能改变建造的顺序，因为我们不可能在打地基之前就装窗户。

因此，在这个例子中，我们可以创建一个模板方法，使用不同的方式建造房子。

点击模板方法查看实现细节。

### 2. 中介者模式

中介者模式用于在系统的不同对象间提供一个集中通讯的媒介。

中介者模式在多个对象相互作用的企业应用中非常有用。

如果这些对象直接进行交互，系统组件就会变得紧耦合，维护成本更高并且不利于扩展。

中介者模式专注于为多个对象间的通讯提供一个媒介，帮助实现对象间的松耦合。

空中交通控制是中介者模式的一个很好的例子，机场控制室相当于不同航班通讯的媒介。

这个媒介如同对象间的路由器一样，并且它可以有自己的通讯逻辑。

点击中介者模式查看实现细节。

### 3. 责任链模式

责任链模式用来实现软件设计中的松耦合，将客户端的请求传递给链中的一个对象进行处理。

之后由该对象决定由谁继续处理这个请求以及请求是否需要被传递给链中的下一个对象。

在 try-catch 代码块中可以进行多次 catch，每个 catch 块都用于处理特定异常的类型。

所以当一个异常出现在 try 代码块中，它被发送到第一个 catch 代码块中进行处理，如果这个 catch 代码块无法处理该异常，它就会把这个异常转发给链中的下一个对象进行处理，也就是下一个 catch 代码块。

如果最后一个 catch 代码块也不能够处理这个异常，那么该异常会被抛出异常处理链的外面到调用程序的地方。

ATM 机出钞的逻辑就可以使用责任链模式实现。

### 4. 观察者模式

当你对某个对象状态感兴趣，每当该状态发生变化时想要得到通知，可以使用观察者模式。

在观察者模式中，观察其它对象的状态的对象被称为观察者，被观察的对象被称为主题。

Java 为实现观察者模式提供了内置的 java.util.Observable 类和 java.util.Observer 接口。

然而并没有得到广泛的使用，因为该实现过于简单，而且大多数时候我们不希望仅仅为了实现观察者模式而去继承一个类，因为 Java 中没有多继承的概念。

Java 消息服务（JMS）使用观察者模式和中介者模式使应用可以订阅和发布数据到其它应用。

点击观察者模式查看实现细节。

### 5. 策略模式

当一个特定的任务有多个算法，程序运行时由客户端决定使用哪个逻辑时使用策略模式。

策略模式也被称为政策模式。

我们定义多个算法，让客户端程序通过参数传递要执行的算法。

这个模式最好的一个例子之一是 Collectionis.sort() 方法，该方法接收一个 Comparator 参数，基于 Comparator 接口不同的实现，以不同的方式排序集合中的对象。

点击策略模式查看实现细节和示例。

### 6. 命令模式

命令模式被用于在请求——响应模型中实现松耦合。

命令模式中，发送请求给调用者，调用者传递请求给封装的命令对象。

命令对象传递请求给接收者相应的方法执行。

例如我们想要提供一个文件系统，可以打开、写入、关闭文件，并且这个文件系统能够支持不同的操作系统，比如 Windows 和 Unix。

为了实现我们的文件系统，首先需要创建实际完成任务的接收者类。

由于我们是面向接口编程，我们可以定义一个文件系统接收者的接口（FileSystemReceiver）和不同操作系统的实现类，像是 Windows、Unix、Solaris等等。

点击命令模式查看实现细节。

### 7. 状态模式

状态模式被用于当一个对象基于其内部的状态改变它的行为时。

如果我们必须基于一个对象的状态改变它的行为，我们可以在这个对象中定义一个状态然后使用 if-else 代码块基于不同的状态执行不同的操作。

状态模式提供一种系统的、松耦合的方式取得这样的效果，具体做法是通过上下文对象（Context）和状态对象（State）来实现。

点击状态模式查看实现细节。

### 8. 访问者模式

当我们必须在一组相似类型的对象上执行一个操作时使用访问者模式。

通过访问者模式，我们可以将操作逻辑从这些对象上面移出到另一个类上面。

举个例子，想象有一个购物车可以添加不同类型的商品，当我们点击结账按钮时，计算出总金额。目前，我们可以将计算逻辑放在每个商品类里面，或者我们可以使用访问者模式把计算逻辑移出到另一个类上面。

让我们一起来实现它，点击访问者模式查看实现细节。

### 9. 解释器模式

解释器模式用于定义语言的语法特征，并提供一个解释器解释这种语法。

最好的例子就是 Java 的编译器，将 Java 源码编译为能够被 JVM 识别的字节码。

谷歌的翻译器同样是应用解释器模式的一个很好的例子，我们在谷歌翻译器中输入任意语言，结果以另外一种语言展现出来。

点击解释器模式查看示例代码。

### 10. 迭代器模式

迭代器模式提供了标准的方式遍历一组对象。

迭代器模式被广泛的应用在 Java 集合框架中，Iterator 接口提供了遍历集合的方法。

迭代器模式不仅能够遍历集合，基于我们的需求也能够提供不同类型的迭代器。

迭代器模式隐藏了遍历集合真实的实现，客户端程序只需要使用迭代方法。

点击迭代器模式查看代码示例。

### 11. 备忘录模式

当我们想保存一个对象的状态以便于以后可以恢复时使用备忘录模式。

备忘录模式是通过保存该对象的状态不能够从对象外部访问的方式实现的，从而保护了状态数据的完整性。

备忘录模式通过两个对象——创始者（Originator）和守护者（Caretaker）实现。

创始者是需要保存和恢复状态的对象，使用内部类保存对象的状态。

这个内部类被称为备忘录，它是私有的，因此不能够被其它对象访问。

点击备忘录模式查看示例程序。

## 其它设计模式

有大量的设计模式没有被”四人帮“（GOF）收录。

我们接着看一些其它常用的设计模式。

### 1. DAO 设计模式

DAO 设计模式用来解耦数据持久层逻辑到不同的层。

设计带有数据库的系统时，应用 DAO 模式非常普遍。

概念是将服务层和数据访问层分离开。

在我们的应用中实现了这种分离。

点击 DAO 模式查看实现细节和示例程序。

### 2. 依赖注入设计模式

依赖注入允许我们删除硬编码的依赖，使我们的应用松耦合、易扩展、可维护。

在 Java 中我们可以实现依赖注入，将依赖关系从编码时期移动到运行时期。

Spring 框架就是以依赖注入做为框架的基础的。

### 3. MVC 模式

MVC 是用于创建 web 应用最古老的设计模式之一。

MVC 意思是：模型层（Model）——视图层（View）——控制层（Controller）。

点击 MVC 模式 查看详情和完整的示例代码。

以上就是 Java 中的设计模式，这篇文章提供索引以方便浏览他们。



---

原文：

[Java 设计模式](https://www.journaldev.com/1827/java-design-patterns-example-tutorial)

